import os

from .get_login import GoshawkLogin

_ROOT = os.path.abspath(os.path.dirname(__file__))

AWS_DATA_PATH = 'AWS_DATA_PATH'


# Entry point for Botocore
def awscli_initialize(hooks):
    update_os_environ(os.environ)
    register_events(hooks)


def update_os_environ(os_environ):
    DATA_ROOT = os.sep.join([_ROOT, 'data', 'models'])
    if AWS_DATA_PATH not in os_environ:
        os_environ[AWS_DATA_PATH] = DATA_ROOT
    else:
        os_environ[AWS_DATA_PATH] += os.pathsep + DATA_ROOT


def register_events(event_emitter):
    event_emitter.register('building-command-table.goshawk', _inject_get_login)


# inject custom `get-login` command
def _inject_get_login(command_table, session, **kwargs):
    command_table['get-login'] = GoshawkLogin(session)


update_os_environ(os.environ)
